<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Créer votre compte</title>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
        <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    <link rel="stylesheet" href="entetestylef.css" media="screen" title="no title" charset="utf-8">
    <link rel="stylesheet" href="sign-up.css" media="screen" title="no title" charset="utf-8">
    <link href="https://fonts.googleapis.com/css?family=Archivo+Narrow" rel="stylesheet">
  </head>
  <body>
      <div class="container-fluid en-tete">
        <div class="row">
          <div class="col-lg-1 col-xs-1">
            <div class="element-en-tete element-en-tete1">FIND</div>
          </div>
          <div class="col-lg-11 col-xs-11">
            <div class="element-en-tete-droit">
              <div class="element-en-tete element-en-tete2"></div>
              <div class="element-en-tete element-en-tete2"></div>
              <div class="element-en-tete element-en-tete2"></div>
              <div class="element-en-tete element-en-tete3"><a href="sign-up.html">Se Connecter</a></div>
            </div>
          </div>
        </div>
      </div>
    <p>Connexion</p>
    <!--TOFIX : améliorer la sortie des messages d'erreurs-->

    <div class="container">
      <form class="form-horizontal col-lg-6 col-xs-12">
        <p class="col-lg-offset-2 titre-creation">Crée votre compte</p>
        <div class="form-group">
          <label class="control-label col-lg-4 col-xs-3" for="nom">Nom:</label>
          <div class="col-sm-8 col-xs-8">
            <input type="text" class="form-control" id="nom" placeholder="Dupont">
          </div>
        </div>

        <div class="form-group">
          <label class="control-label col-lg-4 col-xs-3" for="prenom">Prenom:</label>
          <div class="col-lg-8 col-xs-8">
            <input type="text" class="form-control" id="prenom" placeholder="Jean">
          </div>
        </div>

        <div class="form-group">
            <label class="control-label col-lg-4 col-xs-3" for="sexe">Sexe:</label>
            <div class="checkbox col-lg-8 col-xs-8">
              <label><input type="radio" name="sexe" class="sexe"> Femme</label>
              <label><input type="radio" name="sexe" class="sexe"> Homme</label>
            </div>
          </div>

      <div class="form-group">
          <label class="control-label col-lg-4 col-xs-3" for="login">Login (mail):</label>
          <div class="col-lg-8 col-xs-8">
            <input type="login" class="form-control" id="login" placeholder="jean.dupont@gmail.com">
          </div>
        </div>

        <div class="form-group">
          <label class="control-label col-lg-4 col-xs-3" for="mdp">Mot de passe:</label>
          <div class="col-lg-8 col-xs-8">
            <input type="password" class="form-control" id="mdp" placeholder="********">
          </div>
        </div>

        <div class="form-group">
          <label class="control-label col-lg-4 col-xs-3" for="mdpConfirm">Confirmer mot de passe:</label>
          <div class="col-lg-8 col-xs-8">
            <input type="password" class="form-control" id="mdpConfirm" placeholder="********">
          </div>
        </div>

        <div class="form-group">
            <label class="control-label col-lg-4 col-xs-3" for="status">Status: </label>
            <div class="checkbox col-lg-8 col-xs-8">
              <label><input type="radio" name="status" class="status"> Professionel</label>
              <label><input type="radio" name="status" class="status"> Particulier</label>
            </div>
          </div>

        <div class="form-group">
          <div class="col-lg-offset-4 col-xs-offset-3 col-xs-8">
            <button type="submit" class="col-lg-12 col-xs-12" id="submit" onclick="nouveauCompte()">Créer un compte</button>
          </div>
        </div>

      </form>



      <form class="form-horizontal col-lg-6 col-xs-12 connexion">
        <p class="col-lg-offset-4">Connectez-vous</p>

        <div class="form-group">
          <label class="control-label col-lg-4 col-xs-3" for="loginco">Login:</label>
          <div class="col-sm-8 col-xs-8">
            <input type="text" class="form-control" id="loginco" name="loginco" placeholder="jean.dupont@gmail.com">
          </div>
        </div>

        <div class="form-group">
          <label class="control-label col-lg-4 col-xs-3" for="mdpco">Mot de passe:</label>
          <div class="col-lg-8 col-xs-8">
            <input type="password" class="form-control" id="mdpco" name="mdpco" placeholder="********">
          </div>
        </div>

        <div class="form-group">
          <div class="col-lg-offset-4 col-xs-offset-3 col-xs-8">
            <button type="submit" class="col-lg-12 col-xs-12" id="submit" onclick="ajaxConnexion()">Connexion</button>
          </div>
        </div>

      </form>
      </div>
 <!-- TODO : authentification via Facebook -->
    <script type="text/javascript">

    function nouveauCompte(){
        var nom = document.getElementById("nom").value;
        var prenom = document.getElementById("prenom").value;
        var sexe1= document.getElementsByClassName("sexe")[0].checked;
        var sexe2= document.getElementsByClassName("sexe")[1].checked;
        var login = document.getElementById("login").value;
        var mdp = document.getElementById("mdp").value;
        var mdpConfirm = document.getElementById("mdpConfirm").value;
        var status1 = document.getElementsByClassName("status")[0].checked;
        var status2 = document.getElementsByClassName("status")[1].checked;
        // TOFIX : mettre plus de verification nottament pour le nom et prenom pas de caracteres speciaux (voir la methode dans les input html css)
        // envoyer les bouton radio
        if(nom !== "" && prenom !== "" && sexe1 || sexe2 == true && login !== "" && mdp !== "" && mdpConfirm !== "" && status1 || status2 == true){
          if (login.indexOf("@") < 1){
            alert("Mauvais format, pour rappel il doit comporter au moins un @");
          }if (login.length < 4){
            alert("Le login doit comporter au moins 4 caractères");
          }if(mdp.length < 4){
            alert("Le mot de passe doit comporter au moins 4 caractères");
          }if (mdp !== mdpConfirm){
            alert("Les mots de passe ne correspondent pas");
          }else{
            ajaxCreation();
          }
        }
        else{
          alert("Vous n\'avez rien saisi dans les ou l\'un des champs");
        }
      }

      //TOFIX = methode get
      function ajaxCreation() {

      var xhr=null;

      if (window.XMLHttpRequest) {
          xhr = new XMLHttpRequest();
      }
      else if (window.ActiveXObject)
      {
          xhr = new ActiveXObject("Microsoft.XMLHTTP");
      }
      //on définit l'appel de la fonction au retour serveur
      xhr.onreadystatechange = function() {
       if(xhr.readyState === 4 && xhr.status === 200) {
       alert(xhr.responseText);
       }
     }

      var nom = document.getElementById("nom").value;
      var prenom = document.getElementById("prenom").value;
      var sexe1= document.getElementsByClassName("sexe")[0].checked;
      var sexe2= document.getElementsByClassName("sexe")[1].checked;
      var login = document.getElementById("login").value;
      var mdp = document.getElementById("mdp").value;
      var status1 = document.getElementsByClassName("status")[0].checked;
      var status2 = document.getElementsByClassName("status")[1].checked;

      // if(document.getElementsByClassName("status")== [0]){
      //
      // }

      //on appelle le fichier reponse.txt
      xhr.open("POST", "insert-donnees.php", true);
      xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");//ligne très importante pour la methode post ( des http headers)
      xhr.send('login='+login+'&mdp='+mdp+'&nom='+nom+'&prenom='+prenom);
    }

      function ajaxConnexion(){
        var loginco = document.getElementById("loginco").value;
        var mdpco = document.getElementById("mdpco").value;
        //TOFIX mettre tout en lower case
        if(loginco !== "" && mdpco !== ""){

        if (window.XMLHttpRequest) {
            xhr = new XMLHttpRequest();
        }
        else if (window.ActiveXObject)
        {
            xhr = new ActiveXObject("Microsoft.XMLHTTP");
        }

        var loginco = document.getElementById("loginco").value;
        var mdpco = document.getElementById("mdpco").value;

        //on appelle le fichier reponse.txt
        xhr.open("POST", "verifie-authentification.php", true);
        xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");//ligne très importante pour la methode post ( des http headers)
        xhr.onreadystatechange = function() {
         if(xhr.readyState === 4 && xhr.status === 200) {
         alert(xhr.responseText);
           }
         }
        xhr.send('loginco='+loginco+'&mdpco='+mdpco);
      }else{
        alert("Vous n\'avez rien saisi dans les ou l\'un des champs")
      }
    }
    </script>
  </body>
</html>
